<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AH Gambling</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">


    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto',
                'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background-color: #000000;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header { border-bottom: 1px solid #333333; }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .logo {
            font-size: 1.25rem;
            font-weight: 600;
            color: #ffffff;
            text-decoration: none;
        }

        /* Balance dropdown */
        .balance-wrapper {
            margin-left: auto;
            position: relative;
        }

        .balance-btn {
            background-color: #111111;
            border: 1px solid #333333;
            color: #ffffff;
            padding: 0.5rem 1.25rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .balance-btn:hover {
            background-color: #222222;
            border-color: #555555;
        }

        .balance-menu {
            position: absolute;
            right: 0;
            top: 120%;
            background-color: #111111;
            border: 1px solid #333333;
            border-radius: 8px;
            min-width: 160px;
            padding: 0.5rem 0;
            display: none;
            z-index: 100;
        }

        .balance-menu a {
            display: block;
            padding: 0.5rem 1rem;
            color: #ffffff;
            text-decoration: none;
            font-size: 0.875rem;
        }

        .balance-menu a:hover {
            background-color: #222222;
        }

        .divider {
            height: 1px;
            background-color: #333333;
            margin: 0.4rem 0;
        }

        .balance-wrapper:focus-within .balance-menu {
            display: block;
        }

        main {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 4rem 2rem;
            display: flex;
            justify-content: center;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 900px;
        }

        .card {
            background-color: #111111;
            border: 1px solid #333333;
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.2s ease;
            text-align: left;
        }

        .card:hover {
            border-color: #555555;
            transform: translateY(-2px);
        }

        .card img {
            width: 100%;
            height: auto;
            border-radius: 6px;
            margin-bottom: 1rem;
        }

        .card h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #ffffff;
        }

        .card p {
            color: #888888;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .card a {
            display: inline-flex;
            align-items: center;
            color: #ffffff;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            padding: 0.5rem 1rem;
            background-color: #222222;
            border-radius: 6px;
            border: 1px solid #333333;
            transition: all 0.2s ease;
        }

        .card a:hover {
            background-color: #333333;
            border-color: #555555;
        }

        @media (max-width: 768px) {
            nav {
                flex-direction: column;
                gap: 1rem;
            }

            .balance-wrapper {
                margin-left: 0;
            }

            main {
                padding: 2rem 1rem;
            }

            .cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
<header>
    <nav>
        <a href="/" class="logo">AH Gambling</a>

        <div class="balance-wrapper">
            <button class="balance-btn"></button>
            <div class="balance-menu">
                <a href="/deposit">Deposit</a>
                <a href="/withdraw">Withdraw</a>
                <div class="divider"></div>
                <a href="/logout">Log out</a>
            </div>
        </div>
    </nav>
</header>

<main>
    <div class="cards">
         <!-- <div class="card"> -->
       <!--     <img src="https://example.com/towers-image.jpg" alt="Towers Game Image"> -->
          <!--  <h3>Towers</h3>-->
           <!-- <p> -->
           <!--     Towers is a fast-paced risk-and-reward game where every move matters. Climb higher by choosing safe blocks while avoiding hidden traps that can end your run instantly. Each successful step increases your multiplier, but the higher you go, the greater the risk. Cash out at any time to secure your winnings, or push your luck and aim for the top. Simple to play, thrilling to master—Towers rewards sharp instincts and smart timing. -->
          <!--  </p> -->
           <!--   <a href="/towers">Open →</a> -->
       <!-- </div>  -->

        <div class="card">
            <!-- <img src="https://example.com/mines-image.jpg" alt="Mines Game Image"> -->
            <h3>Mines</h3>
            <p>
               Navigate a field of mines to multiply your bet. Pick your difficulty and uncover safe tiles to increase your winnings.
            </p>
            <a href="/mines">Open →</a>
        </div>
    </div>
</main>

</body>

     <script>
        const wrapper = document.querySelector('.balance-wrapper');
        const modal = document.getElementById('walletModal');
        const closeBtn = document.querySelector('.close');
        const tabs = document.querySelectorAll('.tab');
        const depositBtn = document.getElementById('depositBtn');
        const withdrawBtn = document.getElementById('withdrawBtn');
        const instructions = document.getElementById('instructions');
        const inputField = document.getElementById('amount');

        async function getData() {
            try {
                const response = await fetch('https://arcadehavengambling.vercel.app/getbalance');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                    const data = await response.text(); 
                    const number = parseFloat(data);
            
                    if (isNaN(number)) {
                        console.error('Error: The response is not a valid number');
                        return "Something went wrong!";
                    }

                    return number
            } catch (error) {
                console.error('There was a problem with the fetch operation:', error);
            }
        }
        let count = 0;

        function formatWithCommas(num) {
            return num.toLocaleString();
        }

        async function updateBalance() {
            let balance = await getData();
            if (typeof balance === 'number') {
                balance = balance.toLocaleString(); 
                document.querySelector('.balance-btn').textContent = `$${balance}`;
            } else {
                document.querySelector('.balance-btn').textContent = "Error loading balance";
            }
        }

        updateBalance();

        document.querySelector('.balance-btn').onclick = () => {
            wrapper.classList.toggle('open');
        };

        document.getElementById('openDeposit').onclick = () => openWallet('deposit');
        document.getElementById('openWithdraw').onclick = () => openWallet('withdraw');

        closeBtn.onclick = () => modal.classList.remove('open');
        modal.onclick = e => e.target === modal && modal.classList.remove('open');

        function openWallet(type) {
            modal.classList.add('open');
            switchTab(type);
        }

        function switchTab(type) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));

            const tab = document.querySelector('.tab.' + type);
            tab.classList.add('active');

            if (type === 'deposit') {
                depositBtn.style.display = 'inline-block';
                withdrawBtn.style.display = 'none';

                instructions.innerHTML =
                    `How to deposit:<br>1. Enter the amount you want to deposit<br>2. Click "Initiate Deposit"<br>3. Complete deposit in-game`;
                inputField.value = '';
                inputField.placeholder = 'Enter amount to deposit';
            } else {
                const errorMessage = document.querySelector('.error-message');

                if (errorMessage) { 
                    if (count === 0) {
                        count = count + 1;  
                    } else { 
                        errorMessage.remove();
                    }
                }

                withdrawBtn.style.display = 'inline-block';
                depositBtn.style.display = 'none';

                instructions.innerHTML =
                    `How to withdraw:<br>1. Enter the amount you want to withdraw<br>2. Click "Initiate Withdrawal"<br>3. Complete withdrawal in-game`;
                inputField.value = '';
                inputField.placeholder = 'Enter amount to withdraw';
            }
        }

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const type = tab.classList.contains('deposit') ? 'deposit' : 'withdraw';
                switchTab(type);
            });
        });

        depositBtn.onclick = async () => {
            const amount = parseFloat(inputField.value);
        
            if (isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }
        
            window.location.href = `/deposit?amount=${encodeURIComponent(amount)}`;
        };

        withdrawBtn.onclick = () => {
            const amount = parseFloat(inputField.value);

            if (isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }

            window.location.href = `/withdraw?amount=${encodeURIComponent(amount)}&page=${encodeURIComponent("towers")}`;
        };

        window.onload = function() {
            const errorMessage = document.querySelector('.error-message');
    
            if (errorMessage) {
                openWallet('withdraw');
            }
        };


</script>
</html>


